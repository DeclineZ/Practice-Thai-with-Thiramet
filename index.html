<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <title>Thai Spelling-Trainer</title>
  <style>
    *{box-sizing:border-box;font-family:sans-serif}
    body{max-width:720px;margin:2rem auto;padding:0 1rem;text-align:center}
    h1{font-size:1.9rem;margin-bottom:1rem}
    #trainer{display:none;margin-top:2.5rem}
    #answerInput{width:100%;padding:.7rem;font-size:1.25rem;border:2px solid #ccc;border-radius:6px}
    button{cursor:pointer;border:none;border-radius:6px;padding:.65rem 1.4rem;font-size:1rem;margin:.5rem}
    button:not(:disabled):hover{filter:brightness(1.05)}
    #startBtn      {background:#673ab7;color:#fff}
    #submitBtn     {background:#4caf50;color:#fff}
    #repeatBtn     {background:#2196f3;color:#fff}
    #showAnswerBtn {background:#9e9e9e;color:#fff}
    #feedback{height:1.6rem;margin-top:.7rem;font-weight:bold}
    #voiceSelect{margin-top:1rem;padding:.5rem;font-size:1rem}
  </style>
</head>
<body>
  <h1>‡∏ù‡∏∂‡∏Å‡∏™‡∏∞‡∏Å‡∏î‡∏Ñ‡∏≥‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢</h1>

  <!-- ‚≠ê voice selector -->
  <label for="voiceSelect">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á:</label>
  <select id="voiceSelect"></select>

  <button id="startBtn">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å</button>

  <!-- drill UI -->
  <div id="trainer">
    <p id="counter"></p>
    <div>
      <button id="repeatBtn"      title="‡∏ü‡∏±‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á">üîä ‡∏ü‡∏±‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
      <button id="showAnswerBtn"  title="‡∏î‡∏π‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö">üëÅÔ∏è ‡∏î‡∏π‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>
    </div>
    <form id="answerForm" autocomplete="off">
      <input id="answerInput" type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏¢‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‚Ä¶" required>
      <button id="submitBtn" type="submit">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>
    </form>
    <p id="feedback"></p>
  </div>

<script type="module">
/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 1.  word list (unchanged) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
const WORDS = [ "‡πÑ‡∏ã‡∏ã‡πå","‡∏Ç‡πÇ‡∏°‡∏¢","‡∏á‡∏π‡∏™‡∏ß‡∏±‡∏î","‡πÅ‡∏Ñ‡∏£‡πå‡∏£‡∏≠‡∏ï","‡∏Ç‡∏∞‡∏°‡∏±‡∏Å‡πÄ‡∏Ç‡∏°‡πâ‡∏ô","‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏î‡∏£‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢","‡∏™‡∏∞‡πÄ‡∏´‡∏•‡πà‡∏≠","‡∏Ç‡∏≤‡∏î‡∏î‡∏∏‡∏•","‡∏à‡∏á‡∏Å‡∏£‡∏°",
"‡πÅ‡∏≠‡∏õ‡πÄ‡∏õ‡∏¥‡∏•","‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß‡∏°‡∏π‡∏ô","‡∏à‡∏∞‡∏á‡∏≠‡∏¢","‡∏Å‡∏á‡∏™‡∏∏‡∏•","‡πÄ‡∏Ç‡πâ‡∏≤‡∏å‡∏≤‡∏ô","‡∏à‡∏±‡∏Å‡∏à‡∏±‡πà‡∏ô","‡∏Å‡∏é","‡πÑ‡∏Ç‡πà‡∏°‡∏∏‡∏Å","‡∏à‡∏±‡∏á‡πÑ‡∏£","‡∏à‡∏±‡∏ç‡πÑ‡∏£","‡∏Å‡∏£‡∏∞‡πÄ‡∏û‡∏≤‡∏∞","‡∏Ñ‡∏ó‡∏≤",
"‡∏à‡∏≤‡∏£‡∏∞‡∏ö‡∏µ","‡∏à‡∏£‡∏∞‡∏ö‡∏µ","‡∏Å‡πã‡∏ß‡∏¢‡πÄ‡∏ï‡∏µ‡πã‡∏¢‡∏ß","‡∏Å‡πä‡∏ß‡∏¢‡πÄ‡∏ï‡∏µ‡πã‡∏¢‡∏ß","‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå","‡∏à‡∏≥‡∏ô‡∏á","‡∏Å‡∏∞‡πÄ‡∏ó‡∏¢","‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å","‡∏ä‡∏°‡∏û‡∏π‡πà‡∏°‡πà‡∏≤‡πÄ‡∏´‡∏°‡∏µ‡πà‡∏¢‡∏ß","‡∏Å‡∏∞‡∏ö‡∏±‡∏á‡∏•‡∏°",
"‡∏Ñ‡∏£‡∏∏‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠","‡∏Ñ‡∏•‡∏∏‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠","‡∏ã‡∏≤‡∏´‡∏£‡∏¥‡πà‡∏°","‡∏ã‡πà‡∏≤‡∏´‡∏£‡∏¥‡πà‡∏°","‡∏Å‡∏∞‡∏û‡∏£‡∏¥‡∏ö","‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì","‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠","‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤","‡∏Ñ‡∏∏‡∏Å‡∏Å‡∏µ‡πâ","‡πÅ‡∏ã‡πà‡∏ö","‡∏Å‡∏∞‡∏´‡∏£‡∏µ‡πà",
"‡πÄ‡∏Ñ‡πâ‡∏Å","‡∏î‡∏≠‡∏Å‡∏à‡∏±‡∏ô","‡∏Å‡∏≥‡πÄ‡∏´‡∏ô‡πá‡∏à","‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå","‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡∏à‡∏±‡∏ô‡∏ó‡πå","‡πÄ‡∏Å‡∏°","‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏á","‡∏ï‡∏±‡∏Å‡∏ö‡∏≤‡∏ï‡∏£","‡πÄ‡∏Å‡∏©‡∏µ‡∏¢‡∏ì‡∏≠‡∏≤‡∏¢‡∏∏",
"‡πÅ‡∏Ñ‡πá‡∏ï‡∏ï‡∏≤‡∏•‡πá‡∏≠‡∏Å","‡∏ï‡∏≤‡∏ô‡∏Ç‡πÇ‡∏°‡∏¢","‡πÄ‡∏Å‡∏©‡∏µ‡∏¢‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠","‡πÅ‡∏Ñ‡∏ö‡∏´‡∏°‡∏π","‡∏ó‡∏≠‡∏ô‡∏ã‡∏¥‡∏•","‡πÄ‡∏Å‡∏©‡∏µ‡∏¢‡∏£‡∏™‡∏°‡∏∏‡∏ó‡∏£","‡πÅ‡∏Ñ‡πá‡∏õ‡∏ä‡∏±‡∏ô","‡∏ó‡∏∞‡πÄ‡∏•‡∏™‡∏≤‡∏ö","‡πÄ‡∏Å‡∏™‡∏£",
"‡πÅ‡∏Ñ‡πá‡∏õ‡πÄ‡∏ä‡∏≠‡∏£‡πå","‡∏ó‡∏π‡∏ï","‡πÄ‡∏Å‡∏≤‡∏ï‡πå","‡πÇ‡∏Ñ‡∏ï‡∏£","‡πÄ‡∏ó‡πà","‡πÅ‡∏Å‡∏á‡∏ö‡∏ß‡∏î","‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤","‡πÄ‡∏ó‡∏Å‡πÅ‡∏Ñ‡∏£‡πå","‡∏Å‡∏•‡πâ‡∏ß‡∏¢‡∏ö‡∏ß‡∏ä‡∏ä‡∏µ","‡∏Ü‡∏£‡∏≤‡∏ß‡∏≤‡∏™","‡πÄ‡∏ó‡πâ‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°",
"‡πÄ‡∏ó‡∏¥‡∏î","‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå","‡∏£‡∏™‡∏ä‡∏≤‡∏ï‡∏¥","‡πÅ‡∏ó‡∏£‡∏Å‡πÅ‡∏ã‡∏á","‡πÅ‡∏õ‡∏£‡∏û‡∏±‡∏Å‡∏ï‡∏£‡πå","‡∏£‡∏±‡∏Å‡∏™‡∏≤‡∏°‡πÄ‡∏™‡πâ‡∏≤","‡∏ò‡∏≥‡∏£‡∏á","‡∏ú‡∏±‡∏î‡πÑ‡∏ó‡∏¢","‡∏£‡∏≤‡∏á ‡πÜ","‡∏ô‡∏Å‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ",
"‡∏ú‡∏±‡∏î‡∏ú‡πà‡∏≠‡∏ô","‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏Å‡∏ö‡∏õ‡∏≤‡∏Å","‡∏ô‡∏≠‡∏ï","‡∏ú‡∏±‡∏î‡∏ß‡∏±‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏û‡∏£‡∏∏‡πà‡∏á","‡∏•‡∏≥‡πÑ‡∏¢","‡∏ô‡∏∞‡∏Ñ‡∏∞","‡∏û‡∏∞‡πÅ‡∏ô‡∏á","‡∏•‡∏¥‡∏î‡∏£‡∏≠‡∏ô","‡∏ô‡∏≤‡∏ô‡∏≤","‡∏û‡∏±‡∏®‡∏î‡∏µ","‡∏•‡∏π‡∏Å‡∏ô‡∏¥‡∏°‡∏¥‡∏ï",
"‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡πÑ‡∏™","‡∏û‡∏≤‡∏Å‡∏¢‡πå‡∏´‡∏ô‡∏±‡∏á","‡∏•‡∏π‡∏Å‡∏ö‡∏≤‡∏®‡∏Å‡πå","‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏Å‡πä‡∏≤‡∏î","‡∏û‡∏¥‡∏®‡∏ß‡∏≤‡∏™","‡πÄ‡∏•‡∏¥‡∏Å‡∏£‡∏≤","‡πÇ‡∏ô‡πâ‡∏ï","‡∏û‡∏¥‡∏™‡∏°‡∏±‡∏¢","‡πÑ‡∏•‡∏Å‡πå","‡∏ö‡πà‡∏ß‡∏á‡∏ö‡∏≤‡∏®",
"‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô","‡∏ß‡∏±‡∏ô‡∏ó‡∏¢‡∏´‡∏±‡∏ï‡∏ñ‡πå","‡∏ö‡∏≠‡∏£‡∏∞‡πÄ‡∏û‡πá‡∏î","‡∏ü‡∏∏‡∏ï‡∏û‡∏≤‡∏ó","‡∏ß‡∏±‡∏ô‡∏ó‡∏¢‡∏≤‡∏ß‡∏∏‡∏ò","‡∏ö‡∏±‡∏á‡∏™‡∏∏‡∏Å‡∏∏‡∏•","‡πÄ‡∏ü‡∏ã‡∏ö‡∏∏‡πä‡∏Å","‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏õ‡∏µ‡πâ‡∏¢‡∏ß","‡∏ö‡∏≤‡∏î‡∏ó‡∏∞‡∏¢‡∏±‡∏Å",
"‡∏†‡∏≤‡∏û‡∏¢‡∏ô‡∏ï‡∏£‡πå","‡∏ß‡∏¥‡πà‡∏á‡∏ú‡∏•‡∏±‡∏î","‡∏ö‡∏≥‡πÄ‡∏´‡∏ô‡πá‡∏à","‡∏°‡∏á‡∏Å‡∏∏‡∏é","‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠","‡∏ö‡∏¥‡∏ì‡∏ë‡∏ö‡∏≤‡∏ï","‡∏°‡∏ì‡∏ë‡∏õ","‡∏ß‡∏¥‡∏´‡∏≤‡∏£‡∏Ñ‡∏î","‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£","‡∏°‡∏±‡∏Ñ‡∏Ñ‡∏∏‡πÄ‡∏ó‡∏®‡∏Å‡πå",
"‡∏ß‡∏µ‡∏î‡∏¥‡∏ó‡∏±‡∏®‡∏ô‡πå","‡πÄ‡∏ö‡∏ç‡∏à‡πÄ‡∏û‡∏™","‡∏°‡∏±‡∏Ñ‡∏ô‡∏≤‡∏¢‡∏Å","‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå","‡πÄ‡∏ö‡∏£‡∏Å","‡∏°‡∏±‡∏î‡∏ï‡∏£‡∏≤‡∏™‡∏±‡∏á","‡πÄ‡∏ß‡∏ô‡∏Ñ‡∏∑‡∏ô","‡πÇ‡∏ö","‡∏°‡∏∏‡∏Å‡∏ï‡∏•‡∏Å","‡∏®‡∏µ‡∏£‡∏©‡∏∞","‡∏õ‡∏£‡∏∞‡∏î‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏î‡∏≠‡∏¢",
"‡πÅ‡∏°‡πà‡πÇ‡∏û‡∏™‡∏û","‡∏™‡πÑ‡∏ö","‡∏õ‡∏•‡∏≤‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå","‡∏¢‡πà‡∏≠‡∏°‡πÄ‡∏¢‡∏≤","‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï","‡∏õ‡∏¥‡∏Å‡∏ô‡∏¥‡∏Å","‡∏£‡∏ñ‡πÄ‡∏°‡∏•‡πå","‡∏™‡∏±‡∏á‡πÄ‡∏Ç‡∏õ","‡∏™‡∏±‡∏ô‡πÇ‡∏î‡∏©","‡πÇ‡∏´‡∏£‡∏∞‡∏û‡∏≤","‡∏≠‡∏∏‡∏ö‡∏≤‡∏ó‡∏ß‡πå",
"‡∏™‡∏±‡∏°‡∏°‡∏ô‡∏≤","‡∏≠‡∏á‡∏Ñ‡∏ä‡∏≤‡∏ï","‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô","‡∏™‡∏≤‡∏ö‡πÄ‡∏™‡∏∑‡πâ‡∏≠","‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï","‡∏õ‡∏≤‡∏£‡∏≤‡∏ä‡∏¥‡∏Å","‡∏™‡∏≤‡∏õ‡πÅ‡∏ä‡πà‡∏á","‡∏≠‡πÄ‡∏ô‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå","‡πÑ‡∏≠‡∏®‡∏Å‡∏£‡∏µ‡∏°","‡∏™‡∏≤‡∏¢‡∏™‡∏¥‡∏ç‡∏à‡∏ô‡πå",
"‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏®","‡∏Å‡∏£‡∏∞‡∏ó‡∏∞","‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÉ‡∏ô","‡∏≠‡∏±‡∏ç‡∏ä‡∏±‡∏ô","‡∏Å‡∏∞‡∏•‡∏∞‡πÅ‡∏°","‡∏™‡∏≥‡∏≠‡∏≤‡∏á","‡∏≠‡∏±‡∏õ‡∏£‡∏µ‡∏¢‡πå","‡∏Å‡∏¥‡∏à‡∏à‡∏∞‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞","‡∏™‡∏¥‡∏£‡∏¥‡∏°‡∏á‡∏Ñ‡∏•","‡∏≠‡∏≤‡πÄ‡∏à‡∏µ‡∏¢‡∏ô","‡∏Å‡∏∏‡∏¢‡∏ä‡πà‡∏≤‡∏¢",
"‡πÄ‡∏™‡∏ô‡πà‡∏´‡πå","‡∏≠‡∏≤‡∏ô‡∏¥‡∏™‡∏á‡∏™‡πå","‡∏Ç‡∏∂‡πâ‡∏ô‡∏â‡πà‡∏≤‡∏¢","‡∏´‡∏•‡∏á‡πÉ‡∏´‡∏•","‡∏≠‡∏≤‡πÄ‡∏û‡∏®","‡∏Ñ‡∏£‡∏¥‡∏™‡∏ï‡πå‡∏®‡∏±‡∏Å‡∏£‡∏≤‡∏ä","‡∏´‡∏•‡∏±‡∏ö‡πÉ‡∏´‡∏•","‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå","‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏Ñ‡∏î",
"‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÑ‡∏´‡∏•","‡∏≠‡∏µ‡πÄ‡∏°‡∏•","‡∏à‡∏±‡∏ï‡∏∏‡∏£‡∏±‡∏™","‡∏î‡∏¥‡∏•‡∏¥‡πÄ‡∏ß‡∏≠‡∏£‡∏µ","‡∏ñ‡∏±‡πà‡∏ß‡∏û‡∏π","‡∏ô‡∏±‡∏ô‡∏ó‡∏ô‡∏≤‡∏Å‡∏≤‡∏£","‡∏ö‡∏•‡πá‡∏≠‡∏Å","‡∏õ‡∏£‡∏∞‡∏à‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤","‡∏õ‡∏£‡∏∞‡∏ï‡∏¥‡∏°‡∏≤‡∏Å‡∏£‡∏£‡∏°","‡πÅ‡∏ú‡πà‡∏´‡∏•‡∏≤",
"‡∏°‡∏´‡∏£‡∏™‡∏û","‡∏°‡∏µ‡πà‡∏™‡∏±‡πâ‡∏ß","‡∏£‡∏±‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå","‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï","‡πÄ‡∏î‡πá‡∏Å‡πÅ‡∏ß‡πâ‡∏ô" ];

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 2.  DOM refs ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
const voiceSelect     = document.getElementById('voiceSelect');  // ‚≠ê
const startBtn        = document.getElementById('startBtn');
const trainer         = document.getElementById('trainer');
const counter         = document.getElementById('counter');
const repeatBtn       = document.getElementById('repeatBtn');
const showAnswerBtn   = document.getElementById('showAnswerBtn');
const answerForm      = document.getElementById('answerForm');
const answerInput     = document.getElementById('answerInput');
const feedback        = document.getElementById('feedback');

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 3.  voice handling ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
let selectedVoice     = null;

function buildVoiceList() {
  // keep only Thai voices
  const voices = speechSynthesis.getVoices().filter(v => v.lang?.startsWith('th'));
  voiceSelect.innerHTML = voices.map((v,i) =>
    `<option value="${i}">${v.name}${v.name.match(/kang|‡∏Å‡∏±‡∏á|‡∏Å‡∏ß|Female|‡∏´‡∏ç‡∏¥‡∏á/i) ? ' (F)' :
                                   v.name.match(/sir|‡∏™‡∏¥‡∏£‡∏¥|Male|‡∏ä‡∏≤‡∏¢/i)   ? ' (M)' : ''}</option>`
  ).join('');
  // choose first female-looking voice, else first voice
  const firstFemaleIdx = voices.findIndex(v => /female|‡∏´‡∏ç‡∏¥‡∏á|kang|‡∏Å‡∏±‡∏á|‡∏Å‡∏ß/i.test(v.name));
  voiceSelect.selectedIndex = firstFemaleIdx >= 0 ? firstFemaleIdx : 0;
  selectedVoice = voices[voiceSelect.selectedIndex] || null;
}

speechSynthesis.onvoiceschanged = buildVoiceList;
buildVoiceList();  // initial run

voiceSelect.onchange = () => {
  const voices = speechSynthesis.getVoices().filter(v => v.lang?.startsWith('th'));
  selectedVoice = voices[voiceSelect.value] || null;
};

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 4.  helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
const speak = word => {
  const u = new SpeechSynthesisUtterance(`‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ ${word}`);
  u.lang = 'th-TH';
  if (selectedVoice) u.voice = selectedVoice;
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
};

const shuffle = a => { for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];} return a; };

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 5.  drill logic ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
let queue=[], current='', showingAnswer=false;
const updateCounter = () => counter.textContent = `‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Ñ‡∏≥: ${queue.length}`;

function nextWord(){
  showingAnswer = false;
  if (!queue.length){
    trainer.innerHTML = '<h2>‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô! ‚úîÔ∏è</h2>';
    return;
  }
  current = queue.shift();
  answerInput.value=''; answerInput.focus();
  feedback.textContent='';
  speak(current);
  updateCounter();
}

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 6.  events ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
answerForm.addEventListener('submit', e=>{
  e.preventDefault();
  const typed = answerInput.value.trim();
  if(typed === current){
    feedback.textContent='‚úîÔ∏è ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
    nextWord();
  }else{
    feedback.textContent='‚ùå ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‚Ä¶';
    if(!showingAnswer) queue.push(current);       // only push once per miss
    speak(current);
    answerInput.select();
  }
});

repeatBtn.onclick    = () => speak(current);

/* ‚≠ê Show answer fixes: reveal but DON‚ÄôT advance */
showAnswerBtn.onclick = () => {
  if(showingAnswer) return;             // already revealed for this round
  feedback.textContent = `‚Üí ${current}`;
  queue.push(current);                  // add to back for later
  showingAnswer = true;                 // flag so we don't push twice
  answerInput.focus();
};

startBtn.onclick = () => {
  queue = shuffle([...WORDS]);
  startBtn.style.display='none';
  trainer.style.display='block';
  nextWord();
};
</script>
</body>
</html>
